<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: Tips&tricks | Coding in the Sky]]></title>
  <link href="http://laputa.io/blog/categories/tips-and-tricks/atom.xml" rel="self"/>
  <link href="http://laputa.io/"/>
  <updated>2015-09-21T20:30:17+09:00</updated>
  <id>http://laputa.io/</id>
  <author>
    <name><![CDATA[laputa]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[FFmpeg Practice Commands]]></title>
    <link href="http://laputa.io/blog/2012/08/26/ffmpeg-practice-commands/"/>
    <updated>2012-08-26T00:00:00+09:00</updated>
    <id>http://laputa.io/blog/2012/08/26/ffmpeg-practice-commands</id>
    <content type="html"><![CDATA[<!--more-->


<h2>Convert video for HTC Desire by FFmpeg</h2>

<pre><code>ffmpeg -i inputfile.mpg \
-aspect 16:9 -s 800x480 \
-vcodec libx264 -b 480k -vpre slow_firstpass -vpre baseline -r 13 \
-acodec libfaac -ab 128k -sameq \
-pass 1 -f rawvideo -an -y /dev/null &amp;&amp; \
ffmpeg -i inputfile.mpg \
-aspect 16:9 -s 800x480 \
-vcodec libx264 -b 480k -vpre slow -vpre baseline -r 13 \
-acodec libfaac -ab 128k -ac 2 -sameq \
-pass 2 outputfile.mp4

ffmpeg -y -i Pixar.Short.Films.Collection.2008.Presto.1080p.BluRay.x264.AC3-WiKi.mkv  -s 800x450 -aspect 16:9 -r 24000/1001 -b 480k -vcodec libx264 -pass 1 -vpre fast_firstpass -vpre baseline -an -f rawvideo /dev/null &amp;&amp; ffmpeg -y -i Pixar.Short.Films.Collection.2008.Presto.1080p.BluRay.x264.AC3-WiKi.mkv -s 800x450 -aspect 16:9 -r 24000/1001 -b 480k -vcodec libx264  -vpre slow -vpre baseline -acodec libfaac -ar 32k -ab 128k -ac 2 -sameq -pass 2 out.mp4

ffmpeg -y -i Pixar.Short.Films.Collection.2008.Presto.1080p.BluRay.x264.AC3-WiKi.mkv  -s 320x180 -vf pad=320:240:0:30 -r 24000/1001 -b 240k -vcodec libx264 -pass 1 -vpre fast_firstpass -vpre baseline -an -f rawvideo /dev/null &amp;&amp; ffmpeg -y -i Pixar.Short.Films.Collection.2008.Presto.1080p.BluRay.x264.AC3-WiKi.mkv -s 320x180 -vf pad=320:240:0:30 -r 24000/1001 -b 240k -vcodec libx264  -vpre slow -vpre baseline -acodec libfaac -ar 32k -ab 128k -ac 2 -sameq -pass 2 out_320x240.mp4
</code></pre>

<h2>keep ratio</h2>

<p>  ffmpeg -filters:</p>

<p>  Pad input image to width:height[:x:y[:color]] (default x and y: 0, default color: black). from 1920x1080 to 800x480</p>

<pre><code>ffmpeg -i in -s 800x450 -vf pad=800:480:0:15 out
</code></pre>

<h2>tricks</h2>

<ul>
<li><p> grab screen</p>

<pre><code>ffmpeg -f x11grab -r 25 -s wxga -i :0.0 /tmp/outputFile.mpg
</code></pre></li>
<li><p> extrac image</p>

<p>   1 image per second(default is 25 without -r)</p>

<pre><code>ffmpeg -i test.mpg -r 1 image%d.jpg
</code></pre></li>
<li><p> image to video</p>

<pre><code>ffmpeg -f image2 -i img%d.jpg /tmp/a.mpg
</code></pre></li>
<li><p> capture from cam and mic</p>

<pre><code>ffmpeg -f oss -i /dev/dsp -f video4linux2 -s 320x240 -i /dev/video0 out.mpg
</code></pre></li>
</ul>


<h2>configure options</h2>

<ul>
<li><p> install:</p>

<p>  dependence: yasm faad2-devel faac-devel lame-devel opencore-amr-devel openjpeg-devel libtheora-devel libvpx-devel libvorbis-devel xvidcore-devel</p>

<pre><code>./configure --prefix=/usr --disable-static --enable-shared --enable-gpl --enable-version3 --enable-nonfree --enable-postproc --enable-x11grab --enable-libopencore-amrnb --enable-libopencore-amrwb --enable-libfaac --enable-libmp3lame --enable-libopenjpeg --enable-libtheora --enable-libvorbis --enable-libvpx --enable-libx264 --enable-libxvid --disable-debug

(optional) --enable-libvo-aacenc --enable-libvo-amrwbenc

make &amp;&amp; sudo make install
</code></pre></li>
<li><p> build &amp; install libx264</p>

<pre><code>./configure --prefix=/usr --enable-shared
make &amp;&amp; sudo make install
</code></pre></li>
<li><p> reconfigure ffmpeg add &ndash;enable-libx264</p>

<pre><code>make &amp;&amp; make 
</code></pre></li>
</ul>


<h2>install libvo-aacenc libvo-amrwbenc</h2>

<ul>
<li><p> get from opencore-amr sourceforge</p></li>
<li><p> install:</p>

<pre><code>$ autoreconf
$ ./configure
$ make &amp;&amp; sudo make install
</code></pre></li>
</ul>


<h2>output rtp</h2>

<pre><code>ffmpeg -re -i ~/Videos/test/Ice.Age.Continental.Drift_CIF_352x288.mp4 \
-an -vcodec libx264 -r 20 -g 45 -s 352x288 -deinterlace -f rtp rtp://127.0.0.1:9012 \
-vn -acodec libfaac -ac 2 -ab 192k -ar 44100 -async 1 -flags +global_header -f rtp rtp://127.0.0.1:9014rtp://127.0.0.1:9014
</code></pre>
]]></content>
  </entry>
  
</feed>
